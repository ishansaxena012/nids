<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SentinelWatch</title>

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="header" role="banner">
    <div class="header-inner">
      <div class="brand">
        <svg width="36" height="36" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M3 3h18v18H3z" opacity="0.08"></path>
          <path fill="currentColor" d="M6 7h12v2H6zM6 11h8v2H6zM6 15h12v2H6z"></path>
        </svg>
        <div class="brand-text">
          <h1 class="brand-title">NIDS Dashboard</h1>
          <p class="brand-sub">Real-time intrusion detection overview</p>
        </div>
      </div>

      <div class="header-actions">
        <div class="status small" aria-live="polite" role="status" id="last-update">
          Last update: <time id="last-update-time">—</time>
        </div>

        <div class="control-row">
          <label class="live-toggle" for="live-toggle">
            <!-- <input id="live-toggle" type="checkbox" aria-checked="false" /> -->
            <span>•</span>
            <span class="live-label">LIVE</span>
          </label>

          <!-- <button id="import-btn" class="btn small" type="button" title="Import alerts or rules" aria-label="Import rules or alerts">Import</button> -->
          <!-- <button id="export-btn" class="btn small" type="button" title="Export current view" aria-label="Export CSV">Export</button> -->
          <!-- <button id="settings-btn" class="btn small" type="button" title="Settings" aria-label="Settings">Settings</button> -->
        </div>
      </div>
    </div>
  </header>

  <main id="main" role="main" class="main-wrap">
    <!-- Controls row -->
    <section class="controls-section" aria-label="Controls">
      <div class="controls-inner">
        <div class="search-wrap">
          <label for="search" class="visually-hidden">Search alerts</label>
          <input
            id="search"
            type="search"
            placeholder="Search IP, description, host..."
            aria-label="Search alerts by IP, description, or host"
          />
        </div>

        <div class="filters-wrap">
          <label for="severity-filter" class="visually-hidden">Severity</label>
          <select id="severity-filter" aria-label="Filter by severity">
            <option value="">All severities</option>
            <option value="critical">Critical</option>
            <option value="high">High</option>
            <option value="medium">Med</option>
            <option value="low">Low</option>
          </select>

          <label for="rule-filter" class="visually-hidden">Rule</label>
          <select id="rule-filter" aria-label="Filter by rule">
            <option value="">All rules</option>
          </select>

          <!-- <button id="clear-filters" class="btn" type="button">Clear</button> -->
        </div>

        <div class="meta-actions">
          <div class="small muted" id="result-count" aria-live="polite">— alerts</div>
        </div>
      </div>
    </section>

    <div id="container" class="grid" role="region" aria-label="Main dashboard container">

      <section id="alerts-section" aria-labelledby="alerts-heading" class="card">
        <div class="card-header">
          <h2 id="alerts-heading">Alerts</h2>

          <div class="card-actions">
            <button id="bulk-ack" class="btn" type="button" aria-label="Acknowledge selected alerts">Acknowledge</button>
            <button id="bulk-export" class="btn" type="button" aria-label="Export selected alerts">Export</button>
          </div>
        </div>

        <div
          class="table-wrapper"
          id="alerts-table-wrapper"
          style="max-height:480px; overflow:auto;"
          role="region"
          aria-label="Alerts table"
        >
          <table id="alerts-table" class="data-table table-stack-on-small" aria-describedby="alerts-help">
            <caption id="alerts-help" class="visually-hidden">
              List of alerts with source, destination, protocol, severity, description and host (site)
            </caption>
            <thead>
              <tr>
                <th scope="col" class="col-id">
                  <input type="checkbox" id="select-all" aria-label="Select all alerts" />
                </th>
                <th scope="col" class="col-id">ID</th>
                <th scope="col" class="col-src">Source</th>
                <th scope="col" class="col-dst">Destination</th>
                <th scope="col" class="col-proto">Proto</th>
                <th scope="col" class="col-sev">Severity</th>
                <th scope="col" class="col-desc wrap">Description / Host</th>
                <th scope="col" class="col-actions">Actions</th>
              </tr>
            </thead>
            <tbody aria-live="polite" id="alerts-tbody">
            </tbody>
          </table>
        </div>

        <div class="table-footer">
          <div class="pagination" id="pagination" role="navigation" aria-label="Alerts pagination">
          </div>
          <div class="table-legend small muted">
            <span class="legend-item"><span class="pill severity high"></span> High</span>
            <span class="legend-item"><span class="pill severity medium"></span> Med</span>
            <span class="legend-item"><span class="pill severity low"></span> Low</span>
          </div>
        </div>
      </section>

      <aside class="sidebar card" aria-labelledby="rules-heading">
        <div class="card-header">
          <h2 id="rules-heading">Rules</h2>
          <div class="card-actions">
            <!-- <button id="new-rule" class="btn" type="button" aria-label="Create new rule">New</button>
            <button id="import-rules" class="btn" type="button" aria-label="Import rules">Import</button> -->
          </div>
        </div>

        <div
          class="table-wrapper"
          id="rules-table-wrapper"
          style="max-height:240px; overflow:auto;"
          role="region"
          aria-label="Rules table"
        >
          <table id="rules-table" class="data-table" aria-describedby="rules-help">
            <caption id="rules-help" class="visually-hidden">List of detection rules</caption>
            <thead>
              <tr>
                <th scope="col" class="col-id">ID</th>
                <th scope="col" class="col-name">Name</th>
                <th scope="col" class="col-pattern wrap">Pattern</th>
                <th scope="col" class="col-enabled">Enabled</th>
              </tr>
            </thead>
            <tbody id="rules-tbody">
            </tbody>
          </table>
        </div>

        <h3 class="sidebar-heading">Notifications</h3>
        <div
          id="notifications"
          class="list-panel"
          role="status"
          aria-live="polite"
          style="max-height:180px; overflow:auto; padding-right:6px;"
        >
        </div>

        <h3 class="sidebar-heading">Audit Logs</h3>
        <div
          id="audit-logs"
          class="list-panel"
          role="log"
          aria-live="polite"
          style="max-height:180px; overflow:auto; padding-right:6px;"
        >
        </div>
      </aside>
    </div>
  </main>

  <footer role="contentinfo">
    <div class="footer-inner small muted">
      <span>© <span id="year"></span> Ishan Saxena</span>
      <span>•</span>
      <a
        href="https://docs.google.com/document/d/1pnDwyei8hbpy6tuHpCorJFoQEilcBY0Ak9vf2RXu2NA/edit?usp=sharing"
        id="docs-link"
        class="muted"
      >Docs</a>
      <!-- <span>•</span> -->
      <!-- <a href="#" id="support-link" class="muted">Support</a> -->
    </div>
  </footer>

  <!-- Alert details modal -->
  <div
    id="modal-backdrop"
    class="modal-backdrop"
    aria-hidden="true"
    role="dialog"
    aria-modal="true"
  >
    <div class="modal" role="document" aria-labelledby="modal-title">
      <header class="modal-header">
        <h3 id="modal-title">Alert details</h3>
        <button class="modal-close" id="modal-close" aria-label="Close dialog">&times;</button>
      </header>
      <div class="modal-body" id="modal-body">
      </div>
      <footer class="modal-footer">
        <button id="modal-ack" class="btn" type="button">Acknowledge</button>
        <button id="modal-close-2" class="btn" type="button">Close</button>
      </footer>
    </div>
  </div>

  <!-- Rule edit modal -->
  <div
    id="rule-modal-backdrop"
    class="modal-backdrop"
    aria-hidden="true"
    role="dialog"
    aria-modal="true"
  >
    <div class="modal" role="document" aria-labelledby="rule-modal-title">
      <header class="modal-header">
        <h3 id="rule-modal-title">Edit Rule</h3>
        <button class="modal-close" id="rule-modal-close" aria-label="Close dialog">&times;</button>
      </header>
      <form id="rule-form" class="modal-body" aria-describedby="rule-form-desc">
        <div id="rule-form-desc" class="visually-hidden">
          Edit rule name, pattern and enabled state
        </div>
        <label for="rule-id" class="visually-hidden">Rule ID</label>
        <input id="rule-id" name="id" type="text" readonly class="form-field" />

        <label for="rule-name" class="form-label">Name</label>
        <input id="rule-name" name="name" type="text" class="form-field" />

        <label for="rule-pattern" class="form-label">Pattern</label>
        <textarea id="rule-pattern" name="pattern" rows="4" class="form-field monospace"></textarea>

        <label class="form-checkbox">
          <input id="rule-enabled" name="enabled" type="checkbox" />
          Enabled
        </label>
      </form>
      <footer class="modal-footer">
        <button id="rule-save" class="btn primary" type="button">Save</button>
        <button id="rule-cancel" class="btn" type="button">Cancel</button>
      </footer>
    </div>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>

  <script src="script.js" defer></script>
</body>
</html>
